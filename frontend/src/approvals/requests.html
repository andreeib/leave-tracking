<template bindable="requests,loading">
    <ul if.bind="loading || !requests.length" class="list-group">
        <li class="list-group-item spinner-wrapper">
            <spinner show.bind="loading"></spinner>
            <span show.bind="!loading">You have no requests here!</span>
        </li>
    </ul>

    <ul class="list-group">
        <li repeat.for="request of requests"
            class="list-group-item ${request.status | computeBadge} approval-row">
            <div>
                <div class="btn-group" if.bind="request.status === 'pending'">
                    <button type="button" class="btn btn-default" click.delegate="approveRequest(request)">
                        <i class="glyphicon glyphicon-ok" style="color: green;"></i>
                    </button>
                    <a class="btn btn-default" href="#/add-request/${request._id}/edit">
                        <i class="glyphicon glyphicon-pencil"></i>
                    </a>
                    <button type="button" class="btn btn-default" click.delegate="rejectRequest(request)">
                        <i class="glyphicon glyphicon-remove" style="color: red;"></i>
                    </button>
                </div>
                <div class="btn-group" if.bind="request.status !== 'pending'">
                    <button
                        type="button"
                        class="btn btn-default dropdown-toggle"
                        data-toggle="dropdown"
                        aria-haspopup="true"
                        aria-expanded="false">
                        Action <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu">
                        <li repeat.for="status of statuses">
                            <a
                                data-analytics-category="approvals"
                                data-analytics-action=${status}
                                click.delegate="updateRequest(request, status)">${status}</a>
                        </li>
                        <li>
                            <a
                                data-analytics-category="approvals"
                                data-analytics-action="canceled"
                                href="#/add-request/${request._id}/edit">Edit</a>
                        </li>
                    </ul>
                </div>
                <span>
                    <strong>${request.user.fullName}</strong> | ${request.workDays | days} | ${request.start | dateFormat}
                    <span show.bind="showExtra(request)">
                        - ${request.end | dateFormat}
                    </span>
                    | ${request.leaveType | humanizeLeave}
                </span>
            </div>
            <span if.bind="request.status !== 'pending' && request.lastUpdatedBy" class="badge badge-pill">
                Updated by
                ${request.lastUpdatedBy.firstName}
                ${request.lastUpdatedBy.lastName}
            </span>
        </li>
    </ul>
</template>